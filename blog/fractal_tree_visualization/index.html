<!-- auto-generated document -->
<html lang = "en">
	<head>
		<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>

		<!-- Bootstrap CSS -->
		<!-- <link href="https://bootswatch.com/4/solar/bootstrap.min.css" rel="stylesheet"> -->
		<link href="https://bootswatch.com/4/slate/bootstrap.min.css" rel="stylesheet">
		

		<!-- Latest compiled and minified JavaScript -->
		<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

		<!-- set title on top of the tab -->
		<title>Unity: Using Animation Curves</title>
	</head>
	<body>
		<center class="jumbotron">
			<h2> 
				Unity: Using Animation Curves
			</h2>
		</center>

		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Motivation
				</div>
			</h3>

			<p>
				I came across a 
				<a target="_blank" href="https://www.youtube.com/watch?v=0jjeOYMjmDU">youtube video</a>
				which showed a way to visualize fractal trees. I watched it while eating dinner and didn’t think much of it at the time. A week or two later, though, I had decided to a do a few more challenges for my
				<a target="_blank" href="https://github.com/bi3mer/challenges">challenges repository</a>
				and this was at the top of the list. It is a fairly simple program that has a cool end result seen in figures one and four.
			</p>

			<center>
				<figure align="center">
					<img src="https://github.com/bi3mer/challenges/blob/master/Challenge037_FractalTree/pictures/pi_over_7_160_length.png?raw=true" width="450"/>
					<figcaption>
						Figure 1: Example tree visualization.
					</figcaption>
				</figure>
			</center>
		</div>


		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Tools
				</div>
			</h3>

			<p>
				The aforementioned tutorial used 
				<a target="_blank" href="https://p5js.org/">p5.js</a>
				and made it look pretty decent. However, using javascript isn’t something I would do for a personal project that is meant to be fun. As you may have guessed, I decided to use 
				<a target="_blank" href="https://www.python.org/">Python</a>
				instead. The next step is to choose a tool to display the end result. My initial thought was to use
				<a target="_blank" href="https://matplotlib.org/">matplotlib.</a>
				However, the youtube tutorial also had animations. I wasn’t aware of animations being available in matplotlib at the time so I went in a different direction. Instead, I went with 
				<a target="_blank" href="https://www.pygame.org/news">Pygame</a>. I hadn’t used it before, but it I knew it was widely used in the Python community and I could find answers to any of my rudimentary questions online. 

			</p>
		</div>


		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Opening a Window
				</div>
			</h3>

			<p>
				Before we can start visualizing anything, we need a window that we can open and close without crashing. Luckily, there are a lot of sources that can be easily googled including Pygame’s documentation. 
			</p>

			<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">import</span> <span style="color: #f8f8f2">pygame</span>

<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">init()</span>

    <span style="color: #f8f8f2">size</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #ae81ff">800</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">600</span><span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">screen</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_mode(size)</span>
    
    <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_caption(</span><span style="color: #e6db74">&quot;Fractal Tree&quot;</span><span style="color: #f8f8f2">)</span>

    <span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>
    <span style="color: #f8f8f2">clock</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">time</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Clock()</span>

    <span style="color: #66d9ef">while</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">done:</span>
        <span style="color: #f8f8f2">clock</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">tick(</span><span style="color: #ae81ff">10</span><span style="color: #f8f8f2">)</span>

        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">event</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get():</span> 
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">type</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">QUIT:</span> 
                <span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>

    <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">quit()</span>

<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">__name__</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;__main__&#39;</span><span style="color: #f8f8f2">:</span>
    <span style="color: #f8f8f2">main()</span>
</pre></td></tr></table></div>

			<br/>
			<p>
				The above code is the barebones necessary to get a black screen where nothing happens. It runs until the user closes the window. It works by calling the <code>main</code> function at the start. The main function initializes pygame on line 4 and then proceeds to define the size of the window. On line 9 we give the window a title. Line 12 is interesting because it's purpose isn’t exactly clear on a first glance. 
			</p>
			<p>
				Looking at the 
				<a target="_blank" href="https://www.pygame.org/docs/ref/time.html">documentation,</a>
				you’ll find, “By calling <code>Clock.tick(40)</code> once per frame, the program will never run at more than 40 frames per second." This means we are telling pygame that it should run at most 10 frames per a second. Ten frames per a second is a very slow framerate for most games which aim for sixty, but for our black screen this is absolutely fine. After that we check for a pygame event where the user has quit and mark the boolean <code>done</code> as <code>True</code>. From there we tell pygame to quit and we have a black screen. 

			</p>
		</div>



		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Coordinate System and Lines
				</div>
			</h3>

			<p>
				It's time to draw on the screen. To start we need to know how to draw a line. Luckily, pygame provides a very simple function <code>pygame.draw.line</code> which takes in the screen (line 6 of the code above), the color, the start position (<code>x</code> and <code>y</code> coordinates), the end position, and the width of the line. However, it’s very important to understand how the coordinate system works in the engine before going forward.
			</p>

			<center>
				<figure align="center">
					<img src="https://github.com/bi3mer/graphing_code/blob/master/pygame_coordinates/pygame_coordinates.png?raw=true" width="450"/>
					<figcaption>
						Figure 2: Pygame coordinate system.
					</figcaption>
				</figure>
			</center>

			<p>
				A graph of how the coordinate system works can be seen in figure two and the source code can be found
				<a target="_blank" href="https://github.com/bi3mer/graphing_code/blob/master/pygame_coordinates/pygame_coordinates.py">here.</a>
				As you can see the top left of the screen corresponds to 0,0. The bottom right corresponds to the windows width and height.
			</p>
		</div>



		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Drawing the Root
				</div>
			</h3>

			<p>
				Now that we have an understanding of the coordinate system in Pygame we can move towards drawing a tree. First we need to draw the root line or base of the tree. To do this we need the start and the end positions. The start position is being supplied to us by the caller but for the first call it will need to be the width divided by two and the height of the screen (line 54 in the section below). The end position will have to be based on the direction of the line and the length. 
			</p>

			<p>
				The direction of the line can be defined with an angle. In our case, pi over two is a natural fit because we want the line to be vertical at the start. The length of our line can be any number we want but it will have to be negative to fit in the coordinate system of Pygame. This could also be accomplished by using a negative angle instead. Drawing the line can be seen in the code below:
			</p>


<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2
3
4
5
6
7
8</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">draw_line</span><span style="color: #f8f8f2">(screen,</span> <span style="color: #f8f8f2">start_pos,</span> <span style="color: #f8f8f2">line_length,</span> <span style="color: #f8f8f2">current_angle):</span>
    <span style="color: #f8f8f2">end_position</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span>
        <span style="color: #f8f8f2">start_pos[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">(line_length</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">math</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">cos(current_angle)),</span>
        <span style="color: #f8f8f2">start_pos[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">(line_length</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">math</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sin(current_angle))]</span>

    <span style="color: #f8f8f2">color</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">255</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">255</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">255</span><span style="color: #f8f8f2">)</span> <span style="color: #75715e"># white</span>
    <span style="color: #f8f8f2">line_width</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span>
    <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">draw</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">line(screen,</span> <span style="color: #f8f8f2">color,</span> <span style="color: #f8f8f2">start_pos,</span> <span style="color: #f8f8f2">end_position,</span> <span style="color: #f8f8f2">line_width)</span>
</pre></td></tr></table></div>



			<br/>
			<p>
				Line 3 defines the <code>x</code> position where we use the start position plus the length of the line multiplied by the cosine of the angle. This is pretty common geometry so I’m going to skip explaining it. Line 4 does the same except for the <code>y</code> coordinate and uses sine. From there we define the color and line width and call the draw line function.
			</p>
		</div>


		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Drawing the Tree
				</div>
			</h3>

			<p>
				Now that we can draw the root, the rest of this problem flows pretty naturally if we implement this recursively. Think of it like we are defining a new base of the tree that branches off the current base. If we change the name of the function <code>draw_line</code> to <code>draw_fractal_tree</code> we now have a clearer name. In the function it should call itself twice, since this is a fractal tree, with different directions.  Before doing this, though, we need to make sure the recursion stops.
			</p>
			<p>
				We could accomplish this by taking a max iterations approach. We could pass an integer on each call where we subtract it by one every time on the next call. Once the value is less than or equal to zero the function stops calling itself. This is a fine approach, but I believe the next approach, that is about to be described, is more natural fit for the problem.
			</p>
			<p>
				A more natural approach is to stop recursion based on the length of the line. Since drawing every branch of the tree with the same length would give a pretty weird looking result, we know the length of each branch should decrease on successive recursive calls. In addition, the tutorial also reduced the line length with every recursive call. To draw the tree we need to define how long the line segment on each call should be. Therefore, if we set a minimum line length we can know when the recursion should stop; this value is on line 14. Line 10 defines the maximum line length. In both cases, you’ll notice that the values are negative. As you’ll recall from the coordinates in figure two, the bottom of the screen is the height value, <code>600</code>. Since we want to draw from the bottom of the screen to the top, we need to move towards 0 rather than away. Rather than creating a coordinate system on top of the existing one with conversions, I decided making the numbers negative would be simpler.
			</p>
			<p>
				Line 25 multiplies the current line length by a constant which should be between 0 and 1. This makes it so the value will approach 0 over time. Line 27 then checks to see if the line length is too small to continue. If not the function ends without an recursive calls. Else we call the function twice. You’ll notice that lines 28 and 29 are exactly the same except for a plus and a minus symbol. These are both using the <code>delta_angle</code> variable which is passed into the function.
			</p>
			<center>
				<figure align="center">
					<img src="pictures/pi_over_two.png" width="200"/>
					<figcaption>
						Figure 3: Example fractal tree where <code>delta_angle</code> is set to pi over two.
					</figcaption>
				</figure>
			</center>
			<p>
				The <code>delta_angle</code> variable is what defines how far direction changes for the next branch. If it was set to 0, then you would see only a straight line. If it was set to pi over two, ninety degrees, then you get two perpendicular lines seen in figure three.
			</p>
			<p>
				With the tree implemented, all we have to do is make a few changes to our main function to see the results. The first change is in the for loop between lines 45 and 47 where the escape key now quits the window. First a check for a keydown is done and if that is true then a check for the escape key is done. Lastly, below the for loop, the screen is set to black and the tree is drawn. The flip call will update the entire display.
			</p>

			<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #f92672">from</span> <span style="color: #f8f8f2">math</span> <span style="color: #f92672">import</span> <span style="color: #f8f8f2">pi</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">pygame</span>
<span style="color: #f92672">import</span> <span style="color: #f8f8f2">math</span>

<span style="color: #f8f8f2">BLACK</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span>  <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span>   <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">,</span>   <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">)</span>
<span style="color: #f8f8f2">WHITE</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">(</span><span style="color: #ae81ff">255</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">255</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">255</span><span style="color: #f8f8f2">)</span>

<span style="color: #f8f8f2">MIN_ANGLE</span>           <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
<span style="color: #f8f8f2">MAX_ANGLE</span>           <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pi</span> 
<span style="color: #f8f8f2">LINE_LENGTH</span>         <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">160</span>
<span style="color: #f8f8f2">LINE_LENGTH_DIVISOR</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">2.2</span><span style="color: #f92672">/</span><span style="color: #ae81ff">3.0</span>
<span style="color: #f8f8f2">LINE_WIDTH</span>          <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span>

<span style="color: #f8f8f2">MIN_LINE_LENGTH</span>     <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">2</span>

<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">draw_fractal_tree</span><span style="color: #f8f8f2">(screen,</span> <span style="color: #f8f8f2">start_pos,</span> <span style="color: #f8f8f2">line_length,</span> <span style="color: #f8f8f2">delta_angle,</span> <span style="color: #f8f8f2">current_angle):</span>
	<span style="color: #f8f8f2">end_position</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span>
		<span style="color: #f8f8f2">start_pos[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">(line_length</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">math</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">cos(current_angle)),</span>
		<span style="color: #f8f8f2">start_pos[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">(line_length</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">math</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">sin(current_angle))]</span>
	<span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">draw</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">line(screen,</span> <span style="color: #f8f8f2">WHITE,</span> <span style="color: #f8f8f2">start_pos,</span> <span style="color: #f8f8f2">end_position,</span> <span style="color: #f8f8f2">LINE_WIDTH)</span>

	<span style="color: #f8f8f2">line_length</span> <span style="color: #f92672">*=</span> <span style="color: #f8f8f2">LINE_LENGTH_DIVISOR</span>

	<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">line_length</span> <span style="color: #f92672">&lt;</span> <span style="color: #f8f8f2">MIN_LINE_LENGTH:</span>
		<span style="color: #f8f8f2">draw_fractal_tree(screen,</span> <span style="color: #f8f8f2">end_position,</span> <span style="color: #f8f8f2">line_length,</span> <span style="color: #f8f8f2">delta_angle,</span> <span style="color: #f8f8f2">current_angle</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">delta_angle)</span>
		<span style="color: #f8f8f2">draw_fractal_tree(screen,</span> <span style="color: #f8f8f2">end_position,</span> <span style="color: #f8f8f2">line_length,</span> <span style="color: #f8f8f2">delta_angle,</span> <span style="color: #f8f8f2">current_angle</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">delta_angle)</span>	

<span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
	<span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">init()</span>

	<span style="color: #f8f8f2">size</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #ae81ff">800</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">600</span><span style="color: #f8f8f2">]</span>
	<span style="color: #f8f8f2">screen</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_mode(size)</span>
	
	<span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_caption(</span><span style="color: #e6db74">&quot;Fractal Tree&quot;</span><span style="color: #f8f8f2">)</span>

	<span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>
	<span style="color: #f8f8f2">clock</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">time</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Clock()</span>

	<span style="color: #66d9ef">while</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">done:</span>
		<span style="color: #f8f8f2">clock</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">tick(</span><span style="color: #ae81ff">10</span><span style="color: #f8f8f2">)</span>

		<span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">event</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get():</span> 
			<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">type</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">QUIT:</span> 
				<span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
			<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">type</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">KEYDOWN:</span>
				<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">key</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">K_ESCAPE:</span>
					<span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
		 
		<span style="color: #75715e"># Clear the screen and set the screen background</span>
		<span style="color: #f8f8f2">screen</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">fill(BLACK)</span>

		<span style="color: #75715e"># draw fractal tree at bottom middle of the screen with the first line</span>
		<span style="color: #75715e"># draw straight up at a 90 degree angle</span>
		<span style="color: #f8f8f2">draw_fractal_tree(screen,</span> <span style="color: #f8f8f2">[size[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2.0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">size[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]],</span> <span style="color: #f8f8f2">LINE_LENGTH,</span> <span style="color: #f8f8f2">pi</span><span style="color: #f92672">/</span><span style="color: #ae81ff">5.0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">pi</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2.0</span><span style="color: #f8f8f2">)</span>
		
		<span style="color: #75715e"># Go ahead and update the screen with what we&#39;ve drawn.</span>
		<span style="color: #75715e"># This MUST happen after all the other drawing commands.</span>
		<span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">flip()</span>

	<span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">quit()</span>

<span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">__name__</span> <span style="color: #f92672">==</span> <span style="color: #e6db74">&#39;__main__&#39;</span><span style="color: #f8f8f2">:</span>
	<span style="color: #f8f8f2">main()</span>
</pre></td></tr></table></div>
			<br/>
		</div>


		<div class="container">
			<h3 class="card mb-3">
				<div class="container" id="a_quick_note">
					Animating the Tree
				</div>
			</h3>

			<p>
				What we have is pretty cool but with a few simple changes we can have the more impressive result seen in figure four. To accomplish this, we have to update the <code>delta_angle</code> every frame. In addition, we need to add something to handle when <code>delta_angle</code> has gone too far in one direction and start moving it back the other way. 
			</p>
			<center>
				<figure align="center">
					<img src="https://github.com/bi3mer/challenges/blob/master/Challenge037_FractalTree/pictures/folding.gif?raw=true" width="450"/>
					<figcaption>
						Figure 4: animated fractal tree.
					</figcaption>
				</figure>
			</center>
			<p>
				To update the <code>delta_angle</code> we can can use a simple lerp seen below. This will find the value between the <code>minimum</code> and <code>maximum</code> based on the percent. Therefore if the percent is 0 it will return the <code>minimum</code>. If the percent is 1 it will return <code>maximum</code>.
			</p>

			<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%">1
2</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">lerp</span><span style="color: #f8f8f2">(minimum,</span> <span style="color: #f8f8f2">maximum,</span> <span style="color: #f8f8f2">percent):</span>
    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">minimum</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">percent</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">(maximum</span> <span style="color: #f92672">-</span> <span style="color: #f8f8f2">minimum)</span>
</pre></td></tr></table></div>


			<br/>
			<p>
				The other piece needed is a similarly simple function. The variable <code>current_step</code> is the percentage between 0 and 1 that is used in the <code>lerp</code> function. <code>increment</code> is how much the step should increase every call and can be configured. <code>direction</code> is either -1 or 1 and makes it so the increment is either positive or negative depending on which way the tree is moving. The rest just makes it so percent stays between 0 and 1 and moves between the two over time.
			</p>

			<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">update_step</span><span style="color: #f8f8f2">(current_step,</span> <span style="color: #f8f8f2">increment,</span> <span style="color: #f8f8f2">direction):</span>
    <span style="color: #f8f8f2">new_step</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">current_step</span> <span style="color: #f92672">+</span> <span style="color: #f8f8f2">(increment</span> <span style="color: #f92672">*</span> <span style="color: #f8f8f2">direction)</span>

    <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">new_step</span> <span style="color: #f92672">&lt;=</span> <span style="color: #ae81ff">0</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">direction</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span>
        <span style="color: #f8f8f2">new_step</span>  <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
    <span style="color: #66d9ef">elif</span> <span style="color: #f8f8f2">new_step</span> <span style="color: #f92672">&gt;=</span> <span style="color: #ae81ff">1</span><span style="color: #f8f8f2">:</span>
        <span style="color: #f8f8f2">direction</span> <span style="color: #f92672">=</span> <span style="color: #f92672">-</span><span style="color: #ae81ff">1</span>
        <span style="color: #f8f8f2">new_step</span>  <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span>

    <span style="color: #66d9ef">return</span> <span style="color: #f8f8f2">new_step,</span> <span style="color: #f8f8f2">direction</span>
</pre></td></tr></table></div>

			<br/>
			<p>
				With that added we can update the main function to have two variables <code>current_step</code> and <code>direction</code>. The <code>lerp</code> function is used for the <code>delta_angle</code> in the <code>draw_fractal_tree</code> call. After drawing, we call the <code>update_step</code> which updates the step and direction for the next frame. 
			</p>
			<p>
				The source code of the project can be found 
				<a target="_blank" href="https://github.com/bi3mer/challenges/tree/master/Challenge037_FractalTree">here.</a>
				You’ll notice I separated everything out a bit and added a config file to make it easier to modify behaviour.
			</p>
			<!-- HTML generated using hilite.me --><div style="background: #272822; overflow:auto;width:auto;border:solid gray;border-width:.1em .1em .1em .8em;padding:.2em .6em;"><table><tr><td><pre style="margin: 0; line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41</pre></td><td><pre style="margin: 0; line-height: 125%"><span style="color: #66d9ef">def</span> <span style="color: #a6e22e">main</span><span style="color: #f8f8f2">():</span>
    <span style="color: #75715e"># Initialize the game engine</span>
    <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">init()</span>

    <span style="color: #75715e"># Set the height and width of the screen</span>
    <span style="color: #f8f8f2">size</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">[</span><span style="color: #ae81ff">800</span><span style="color: #f8f8f2">,</span> <span style="color: #ae81ff">600</span><span style="color: #f8f8f2">]</span>
    <span style="color: #f8f8f2">screen</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_mode(size)</span>
    
    <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">set_caption(</span><span style="color: #e6db74">&quot;Fractal Tree&quot;</span><span style="color: #f8f8f2">)</span>
     
    <span style="color: #75715e">#Loop until the user clicks the close button.</span>
    <span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">False</span>
    <span style="color: #f8f8f2">clock</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">time</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">Clock()</span>
    <span style="color: #f8f8f2">current_step</span> <span style="color: #f92672">=</span> <span style="color: #ae81ff">0</span>
    <span style="color: #f8f8f2">direction</span>    <span style="color: #f92672">=</span> <span style="color: #ae81ff">1</span>

    <span style="color: #66d9ef">while</span> <span style="color: #f92672">not</span> <span style="color: #f8f8f2">done:</span>
        <span style="color: #75715e"># This limits the while loop to a max of 10 times per second.</span>
        <span style="color: #75715e"># Leave this out and we will use all CPU we can.</span>
        <span style="color: #f8f8f2">clock</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">tick(</span><span style="color: #ae81ff">10</span><span style="color: #f8f8f2">)</span>
         
        <span style="color: #66d9ef">for</span> <span style="color: #f8f8f2">event</span> <span style="color: #f92672">in</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">get():</span> 
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">type</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">QUIT:</span> 
                <span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
            <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">type</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">KEYDOWN:</span>
                <span style="color: #66d9ef">if</span> <span style="color: #f8f8f2">event</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">key</span> <span style="color: #f92672">==</span> <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">K_ESCAPE:</span>
                    <span style="color: #f8f8f2">done</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">True</span>
         
        <span style="color: #75715e"># Clear the screen and set the screen background</span>
        <span style="color: #f8f8f2">screen</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">fill(Config</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">BLACK)</span>

        <span style="color: #75715e"># draw fractal tree at bottom middle of the screen with the first line</span>
        <span style="color: #75715e"># draw straight up at a 90 degree angle</span>
        <span style="color: #f8f8f2">delta_angle</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">lerp(Config</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">MIN_ANGLE,</span> <span style="color: #f8f8f2">Config</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">MAX_ANGLE,</span> <span style="color: #f8f8f2">current_step)</span>
        <span style="color: #f8f8f2">draw_fractal_tree(pygame,</span> <span style="color: #f8f8f2">screen,</span> <span style="color: #f8f8f2">[size[</span><span style="color: #ae81ff">0</span><span style="color: #f8f8f2">]</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2.0</span><span style="color: #f8f8f2">,</span> <span style="color: #f8f8f2">size[</span><span style="color: #ae81ff">1</span><span style="color: #f8f8f2">]],</span> <span style="color: #f8f8f2">Config</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">LINE_LENGTH,</span> <span style="color: #f8f8f2">delta_angle,</span> <span style="color: #f8f8f2">pi</span><span style="color: #f92672">/</span><span style="color: #ae81ff">2.0</span><span style="color: #f8f8f2">)</span>
        
        <span style="color: #75715e"># Go ahead and update the screen with what we&#39;ve drawn.</span>
        <span style="color: #75715e"># This MUST happen after all the other drawing commands.</span>
        <span style="color: #f8f8f2">pygame</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">display</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">flip()</span>

        <span style="color: #f8f8f2">current_step,</span> <span style="color: #f8f8f2">direction</span> <span style="color: #f92672">=</span> <span style="color: #f8f8f2">update_step(current_step,</span> <span style="color: #f8f8f2">Config</span><span style="color: #f92672">.</span><span style="color: #f8f8f2">STEP,</span> <span style="color: #f8f8f2">direction)</span>
</pre></td></tr></table></div>
		<br/>
		</div>


		<br/>
		<br/>
<!-- Disqus for comments -->
<div id="disqus_thread" class="container"></div>
<script>
/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
	var d = document, s = d.createElement('script');
	s.src = 'https://bi3mer-github-io.disqus.com/embed.js';
	s.setAttribute('data-timestamp', +new Date());
	(d.head || d.body).appendChild(s);
})();
</script>
<noscript>
	Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a>
</noscript>
<script id="dsq-count-scr" src="//bi3mer-github-io.disqus.com/count.js" async></script><script defer src="https://cloud.umami.is/script.js" data-website-id="03289690-de5b-45e9-ad43-20128bb55fdf"></script>	</body>
</html>